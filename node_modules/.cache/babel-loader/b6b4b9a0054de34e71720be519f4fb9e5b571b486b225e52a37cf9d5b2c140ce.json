{"ast":null,"code":"import React,{useState,useEffect}from'react';import{Doughnut}from'react-chartjs-2';import moment from'moment';import axios from'axios';import{jsx as _jsx}from\"react/jsx-runtime\";const DoughnutChart=()=>{const token=localStorage.getItem('token');const[vendasPendentes,setVendasPendentes]=useState([]);const[vendasConvertidas,setvendasConvertidas]=useState([]);const[vendasNaoConvertidas,setvendasNaoConvertidas]=useState([]);useEffect(()=>{const vendasPendentesUltimos30Dias=async()=>{try{let allVendasPendentes=[];let currentPage=0;while(true){const response=await axios.get(\"\".concat(process.env.REACT_APP_API_URL,\"/vendas\"),{headers:{Authorization:\"Bearer \".concat(token)},params:{page:currentPage,size:10}});const vendasPendentes=response.data.content.filter(venda=>venda.status==='PENDENTE'&&venda.data&&moment(new Date(...venda.data)).isAfter(moment().subtract(30,'days')));allVendasPendentes=allVendasPendentes.concat(vendasPendentes);if(response.data.last){break;}currentPage++;}setVendasPendentes(allVendasPendentes.length);}catch(error){console.error('Erro ao obter as vendas pendentes:',error);}};const vendasConvertidasUltimos30Dias=async()=>{try{let allVendasPendentes=[];let currentPage=0;while(true){const response=await axios.get(\"\".concat(process.env.REACT_APP_API_URL,\"/vendas\"),{headers:{Authorization:\"Bearer \".concat(token)},params:{page:currentPage,size:10}});const vendasPendentes=response.data.content.filter(venda=>venda.status==='CONVERTIDO'&&venda.data&&moment(new Date(...venda.data)).isAfter(moment().subtract(30,'days')));allVendasPendentes=allVendasPendentes.concat(vendasPendentes);if(response.data.last){break;}currentPage++;}setvendasConvertidas(allVendasPendentes.length);}catch(error){console.error('Erro ao obter as vendas pendentes:',error);}};const vendasNaoConvertidasUltimos30Dias=async()=>{try{let allVendasPendentes=[];let currentPage=0;while(true){const response=await axios.get(\"\".concat(process.env.REACT_APP_API_URL,\"/vendas\"),{headers:{Authorization:\"Bearer \".concat(token)},params:{page:currentPage,size:10}});const vendasPendentes=response.data.content.filter(venda=>venda.status==='NAO_CONVERTIDO'&&venda.data&&moment(new Date(...venda.data)).isAfter(moment().subtract(30,'days')));allVendasPendentes=allVendasPendentes.concat(vendasPendentes);if(response.data.last){break;}currentPage++;}setvendasNaoConvertidas(allVendasPendentes.length);}catch(error){console.error('Erro ao obter as vendas pendentes:',error);}};vendasPendentesUltimos30Dias();vendasConvertidasUltimos30Dias();vendasNaoConvertidasUltimos30Dias();},[token]);const data={labels:[\"Não-Convertido\",\"Convertido\",\"Pendente\"],datasets:[{data:[vendasNaoConvertidas,vendasConvertidas,vendasPendentes],backgroundColor:['#B22222','#98FB98','#FFA500'],hoverBackgroundColor:['#A52A2A','#90EE90','#FF8C00'],hoverBorderColor:\"rgba(234, 236, 244, 1)\"}]};const options={maintainAspectRatio:false,tooltips:{backgroundColor:\"rgb(255,255,255)\",bodyFontColor:\"#858796\",borderColor:'#dddfeb',borderWidth:1,xPadding:15,yPadding:15,displayColors:false,caretPadding:10},legend:{display:false},cutoutPercentage:80};return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(Doughnut,{data:data,options:options})});};export default DoughnutChart;","map":{"version":3,"names":["React","useState","useEffect","Doughnut","moment","axios","jsx","_jsx","DoughnutChart","token","localStorage","getItem","vendasPendentes","setVendasPendentes","vendasConvertidas","setvendasConvertidas","vendasNaoConvertidas","setvendasNaoConvertidas","vendasPendentesUltimos30Dias","allVendasPendentes","currentPage","response","get","concat","process","env","REACT_APP_API_URL","headers","Authorization","params","page","size","data","content","filter","venda","status","Date","isAfter","subtract","last","length","error","console","vendasConvertidasUltimos30Dias","vendasNaoConvertidasUltimos30Dias","labels","datasets","backgroundColor","hoverBackgroundColor","hoverBorderColor","options","maintainAspectRatio","tooltips","bodyFontColor","borderColor","borderWidth","xPadding","yPadding","displayColors","caretPadding","legend","display","cutoutPercentage","children"],"sources":["C:/Users/JONATA.FESVIP/Desktop/CRM-REACT/src/components/DoughnutChart.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { Doughnut } from 'react-chartjs-2';\r\nimport moment from 'moment';\r\nimport axios from 'axios';\r\n\r\nconst DoughnutChart = () => {\r\n  const token = localStorage.getItem('token');\r\n  const [vendasPendentes, setVendasPendentes] = useState([]);\r\n  const [vendasConvertidas, setvendasConvertidas] = useState([]);\r\n  const [vendasNaoConvertidas, setvendasNaoConvertidas] = useState([]);\r\n\r\n  useEffect(() => {\r\n    const vendasPendentesUltimos30Dias = async () => {\r\n      try {\r\n        let allVendasPendentes = [];\r\n        let currentPage = 0;\r\n    \r\n        while (true) {\r\n          const response = await axios.get(`${process.env.REACT_APP_API_URL}/vendas`, {\r\n            headers: {\r\n              Authorization: `Bearer ${token}`,\r\n            },\r\n            params: {\r\n              page: currentPage,\r\n              size: 10,\r\n            },\r\n          });\r\n    \r\n          const vendasPendentes = response.data.content.filter(venda =>\r\n            venda.status === 'PENDENTE' &&\r\n            venda.data &&\r\n            moment(new Date(...venda.data)).isAfter(moment().subtract(30, 'days'))\r\n          );\r\n    \r\n          allVendasPendentes = allVendasPendentes.concat(vendasPendentes);\r\n    \r\n          if (response.data.last) {\r\n            break;\r\n          }\r\n    \r\n          currentPage++;\r\n        }\r\n    \r\n        setVendasPendentes(allVendasPendentes.length);\r\n    \r\n      } catch (error) {\r\n        console.error('Erro ao obter as vendas pendentes:', error);\r\n      }\r\n    };\r\n\r\n    const vendasConvertidasUltimos30Dias = async () => {\r\n      try {\r\n        let allVendasPendentes = [];\r\n        let currentPage = 0;\r\n    \r\n        while (true) {\r\n          const response = await axios.get(`${process.env.REACT_APP_API_URL}/vendas`, {\r\n            headers: {\r\n              Authorization: `Bearer ${token}`,\r\n            },\r\n            params: {\r\n              page: currentPage,\r\n              size: 10,\r\n            },\r\n          });\r\n    \r\n          const vendasPendentes = response.data.content.filter(venda =>\r\n            venda.status === 'CONVERTIDO' &&\r\n            venda.data &&\r\n            moment(new Date(...venda.data)).isAfter(moment().subtract(30, 'days'))\r\n          );\r\n    \r\n          allVendasPendentes = allVendasPendentes.concat(vendasPendentes);\r\n    \r\n          if (response.data.last) {\r\n            break;\r\n          }\r\n    \r\n          currentPage++;\r\n        }\r\n    \r\n        setvendasConvertidas(allVendasPendentes.length);\r\n    \r\n      } catch (error) {\r\n        console.error('Erro ao obter as vendas pendentes:', error);\r\n      }\r\n    };\r\n\r\n    const vendasNaoConvertidasUltimos30Dias = async () => {\r\n      try {\r\n        let allVendasPendentes = [];\r\n        let currentPage = 0;\r\n    \r\n        while (true) {\r\n          const response = await axios.get(`${process.env.REACT_APP_API_URL}/vendas`, {\r\n            headers: {\r\n              Authorization: `Bearer ${token}`,\r\n            },\r\n            params: {\r\n              page: currentPage,\r\n              size: 10,\r\n            },\r\n          });\r\n    \r\n          const vendasPendentes = response.data.content.filter(venda =>\r\n            venda.status === 'NAO_CONVERTIDO' &&\r\n            venda.data &&\r\n            moment(new Date(...venda.data)).isAfter(moment().subtract(30, 'days'))\r\n          );\r\n    \r\n          allVendasPendentes = allVendasPendentes.concat(vendasPendentes);\r\n    \r\n          if (response.data.last) {\r\n            break;\r\n          }\r\n    \r\n          currentPage++;\r\n        }\r\n    \r\n        setvendasNaoConvertidas(allVendasPendentes.length);\r\n    \r\n      } catch (error) {\r\n        console.error('Erro ao obter as vendas pendentes:', error);\r\n      }\r\n    };\r\n\r\n    vendasPendentesUltimos30Dias();\r\n    vendasConvertidasUltimos30Dias();\r\n    vendasNaoConvertidasUltimos30Dias();\r\n  }, [token]);\r\n\r\n  const data = {\r\n    labels: [\"Não-Convertido\", \"Convertido\", \"Pendente\"],\r\n    datasets: [\r\n      {\r\n        data: [vendasNaoConvertidas, vendasConvertidas, vendasPendentes],\r\n        backgroundColor: ['#B22222', '#98FB98', '#FFA500'],\r\n        hoverBackgroundColor: ['#A52A2A', '#90EE90', '#FF8C00'],\r\n        hoverBorderColor: \"rgba(234, 236, 244, 1)\",\r\n      },\r\n    ],\r\n  };\r\n\r\n  const options = {\r\n    maintainAspectRatio: false,\r\n    tooltips: {\r\n      backgroundColor: \"rgb(255,255,255)\",\r\n      bodyFontColor: \"#858796\",\r\n      borderColor: '#dddfeb',\r\n      borderWidth: 1,\r\n      xPadding: 15,\r\n      yPadding: 15,\r\n      displayColors: false,\r\n      caretPadding: 10,\r\n    },\r\n    legend: {\r\n      display: false,\r\n    },\r\n    cutoutPercentage: 80,\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <Doughnut data={data} options={options} />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default DoughnutChart;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}